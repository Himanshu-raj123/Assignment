<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Submit Assignment</title>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
   <style>
      :root {
         --primary: #667eea;
         --accent: #764ba2;
         --muted: #9aa4c0
      }

      * {
         box-sizing: border-box;
         margin: 0;
         padding: 0
      }

      body {
         font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
         background: #f6f8ff;
         color: #111;
         padding: 24px
      }

      .container {
         max-width: 920px;
         margin: 28px auto
      }

      .card {
         background: #fff;
         border-radius: 12px;
         padding: 20px;
         box-shadow: 0 8px 30px rgba(2, 6, 23, 0.06)
      }

      .grid {
         display: grid;
         grid-template-columns: 1fr 320px;
         gap: 18px
      }

      .field {
         margin-bottom: 12px
      }

      label {
         display: block;
         font-size: 12px;
         color: #6b7280;
         margin-bottom: 6px;
         font-weight: 700;
         text-transform: uppercase
      }

      input[readonly],
      textarea[readonly],
      .static-value {
         background: #f8fafc;
         border: 1px solid #eef2ff;
         padding: 10px;
         border-radius: 8px;
         color: #0f172a;
         width: 100%
      }

      textarea {
         min-height: 110px;
         resize: none
      }

      .file-box {
         background: #fff;
         border: 1px dashed #e6e9f8;
         padding: 12px;
         border-radius: 8px;
         text-align: center
      }

      .btn {
         display: inline-flex;
         align-items: center;
         gap: 8px;
         padding: 10px 14px;
         border-radius: 8px;
         border: none;
         cursor: pointer;
         font-weight: 700
      }

      .btn-primary {
         background: linear-gradient(90deg, var(--primary), var(--accent));
         color: #fff
      }

      .btn-secondary {
         background: #fff;
         border: 1px solid #e6e9f8;
         color: var(--primary)
      }

      .actions {
         display: flex;
         gap: 10px;
         justify-content: flex-end;
         margin-top: 14px
      }

      .note {
         font-size: 13px;
         color: var(--muted);
         margin-top: 6px
      }

      @media (max-width:860px) {
         .grid {
            grid-template-columns: 1fr
         }
      }
   </style>
</head>

<body>

   <div class="container">
      <div class="card">
         <h2 style="color:var(--primary);margin-bottom:8px">Submit Assignment</h2>
         <p class="note">Review the details below. Only choose a reviewer and submit — other fields are fixed.</p>

         <form method="POST" action="/user/submitAssignment/<%= assignment && assignment._id ? assignment._id : '' %>">
            <div class="grid">
               <div>
                  <div class="field">
                     <label>Title</label>
                     <input type="text" name="title"
                        value="<%=assignment.Title %>" readonly />
                  </div>

                  <div class="field">
                     <label>Description</label>
                     <textarea name="description"
                        readonly><%= assignment && assignment.Description ? assignment.Description : '' %></textarea>
                  </div>

                  <div style="display:flex;gap:12px;flex-wrap:wrap">
                     <div style="flex:1">
                        <div class="field">
                           <label>Category</label>
                           <input type="text" name="category"
                              value="<%= assignment && assignment.Category ? assignment.Category : '' %>" readonly />
                        </div>
                     </div>
                     <div style="width:180px">
                        <div class="field">
                           <label>Status</label>
                           <input type="text" name="status"
                              value="<%= assignment && assignment.Status ? assignment.Status : '' %>" readonly />
                        </div>
                     </div>
                  </div>

                  <div class="field">
                     <label>Student Email</label>
                     <input type="text" name="studentEmail"
                        value="<%= assignment && assignment.StudentEmail ? assignment.StudentEmail : (user && user.email ? user.email : '') %>"
                        readonly />
                  </div>

                  <div class="field">
                     <label>File (Name & Size)</label>
                     <div class="file-box">
                        <% if (assignment && assignment.FileName) { %>
                           <div style="font-weight:700;color:#0f172a"><i class="fa-regular fa-file-pdf"
                                 style="color:#e53935;margin-right:8px"></i>
                              <%= assignment.FileName %>
                           </div>
                           <div class="note">Size: <%= assignment.FileSize ? (Math.round(assignment.FileSize/1024)
                                 + ' KB' ) : '—' %>
                           </div>
                           <% } else { %>
                              <div class="note">No file attached.</div>
                              <% } %>
                     </div>
                  </div>
               </div>

               <div>
                  <div class="field">
                     <label>Target Reviewers</label>
                     <select name="reviewer" required
                        style="padding:10px;border-radius:8px;border:1px solid #eef2ff;width:100%">
                        <option value="">-- Select Reviewer --</option>
                        <% if (typeof professors !=='undefined' && professors && professors.length) { %>
                           <% professors.forEach(function(p){ %>
                              <option value="<%= p._id %>">
                                 <%= p.Name  %>
                              </option>
                              <% }); %>
                                 <% } else { %>
                                    <option value="">No reviewers available</option>
                                    <% } %>
                     </select>
                     <div class="note">Only the reviewer selection is editable. All other details are fixed.</div>
                  </div>

                  <div class="field">
                     <label>Reviewer Assigned</label>
                     <div class="static-value" style="padding:10px;border-radius:8px">
                        <%= assignment && assignment.Reviewer ? assignment.Reviewer : 'Not Appointed yet' %>
                     </div>
                  </div>

                  <div class="field">
                     <label>Assignment Id</label>
                     <div class="static-value"
                        style="padding:10px;border-radius:8px;font-family:monospace;word-break:break-all">
                        <%= assignment && assignment._id ? assignment._id : '—' %>
                     </div>
                  </div>

               </div>
            </div>

            <div class="actions">
               <a href="/user/assignments" class="btn btn-secondary">Cancel</a>
               <button type="submit" class="btn btn-primary">Submit for Review</button>
            </div>
         </form>

         <% if (message || error) { %>
            <div style="margin-top:12px" class="note"><strong>
                  <%= error ? 'Error: ' : 'Message: ' %>
               </strong>
               <%= error || message %>
            </div>
            <% } %>

      </div>
   </div>

</body>

</html>